---
title: "440 Project_PCA code"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

Set up
```{r}
# # Download package from Bioconductor
# if (!requireNamespace('BiocManager', quietly = TRUE))
#   install.packages('BiocManager')
# 
# BiocManager::install('PCAtools')

# Load package into R session
  library(PCAtools)
```
```{r}
library(Biobase)
library(GEOquery)

```


```{r}
# load series and platform data from GEO

Sys.setenv("VROOM_CONNECTION_SIZE" = 131072 * 10)

gset <- getGEO("GSE114135", GSEMatrix =TRUE, getGPL=FALSE) # load methylome and transcriptome data. Two platforms used
# gset <- getGEO('GSE114065', GSEMatrix = TRUE, getGPL = FALSE) # GSE114065 = transcriptome data
```


```{r}
# Get index of methylation dataset based on platform (GPL23976)
meth_index <- grep("GPL23976", attr(gset, "names"))

# Get index of transciption dataset based on platform (GPL20301)
trans_index <- grep("GPL20301", attr(gset, "names"))

# Retrieve expression values as dataframe. One column per sample and one row per gene
meth_exp <- exprs(gset[[meth_index]])
trans_exp <- exprs(gset[[trans_index]])
```


```{r}
# test_meth_exp <- exprs(gset[[2]])
# test_trans_exp <- exprs(gset[[1]])

```


```{r}
summary(meth_exp)
```

```{r}
summary(trans_exp)
```


```{r}
meth_pca <- pca(meth_exp)
```


```{r}
write.csv(meth_exp, "C:\\Users\\Amanda\\Desktop\\My Stuff\\MIT\\First Year\\Classes\\Spring Semester\\20.440 Analysis of Biological Networks\\Project\\440 Project\\Data.csv")
```

```{r}
feather::write_feather(meth_exp, "C:\\Users\\Amanda\\Desktop\\My Stuff\\MIT\\First Year\\Classes\\Spring Semester\\20.440 Analysis of Biological Networks\\Project\\440 Project\\Data.csv")
```
